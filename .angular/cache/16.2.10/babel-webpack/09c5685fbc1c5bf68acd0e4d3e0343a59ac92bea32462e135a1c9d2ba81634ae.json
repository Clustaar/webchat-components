{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nconst _c0 = [\"textElement\"];\nfunction TextConsoleActionComponent_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 6);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵstyleProp(\"border-right-color\", ctx_r0.primaryColor);\n  }\n}\nfunction TextConsoleActionComponent_span_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 7);\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵstyleProp(\"border-left-color\", ctx_r2.primaryColor);\n  }\n}\nconst _c1 = function (a0, a1) {\n  return {\n    \"bot\": a0,\n    \"user\": a1\n  };\n};\nexport class TextConsoleActionComponent {\n  constructor(cdr) {\n    this.cdr = cdr;\n    this.inverted = false;\n    this.primaryColor = '#30B286';\n    this.textColor = '#FFFFFF';\n    this.autoScroll = true;\n    this.onLoadNextAction = new EventEmitter();\n    this.onLastActionRendered = new EventEmitter();\n    this.onLinkClicked = new EventEmitter();\n  }\n  ngOnInit() {\n    this.onLoadNextAction.emit(true);\n    if (this.autoScroll) {\n      setTimeout(() => {\n        let element = document.getElementById('chat-console-messages');\n        if (element != null) {\n          element.scrollTop = element.scrollHeight - element.clientHeight;\n          this.cdr.markForCheck();\n        }\n      }, 500);\n    }\n    this.cdr.markForCheck();\n  }\n  ngAfterViewInit() {\n    this.textElement.nativeElement.onclick = event => {\n      if (event.target.href && event.target.nodeName === 'A') {\n        this.onLinkClicked.emit({\n          url: event.target.href,\n          label: event.target.innerText\n        });\n      }\n    };\n    Array.from(document.querySelectorAll('.text-message-' + this.indexAction + ' a')).forEach(function (a) {\n      if (a.getAttribute('target') == null) {\n        a.setAttribute('target', '_blank');\n      }\n    });\n    this.cdr.markForCheck();\n    setTimeout(() => {\n      this.onLastActionRendered.emit(true);\n      this.cdr.markForCheck();\n    }, 0);\n  }\n  /** @nocollapse */\n  static #_ = this.ɵfac = function TextConsoleActionComponent_Factory(t) {\n    return new (t || TextConsoleActionComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef));\n  };\n  /** @nocollapse */\n  static #_2 = this.ɵcmp = /** @pureOrBreakMyCode */i0.ɵɵdefineComponent({\n    type: TextConsoleActionComponent,\n    selectors: [[\"text-console-action\"]],\n    viewQuery: function TextConsoleActionComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.textElement = _t.first);\n      }\n    },\n    inputs: {\n      indexAction: \"indexAction\",\n      action: \"action\",\n      inverted: \"inverted\",\n      primaryColor: \"primaryColor\",\n      textColor: \"textColor\",\n      autoScroll: \"autoScroll\"\n    },\n    outputs: {\n      onLoadNextAction: \"onLoadNextAction\",\n      onLastActionRendered: \"onLastActionRendered\",\n      onLinkClicked: \"onLinkClicked\"\n    },\n    decls: 7,\n    vars: 17,\n    consts: [[1, \"console-text-type\"], [1, \"bubble\", 3, \"ngClass\"], [\"class\", \"bubble-arrow\", 3, \"border-right-color\", 4, \"ngIf\"], [3, \"innerHTML\"], [\"textElement\", \"\"], [\"class\", \"bubble-arrow-right\", 3, \"border-left-color\", 4, \"ngIf\"], [1, \"bubble-arrow\"], [1, \"bubble-arrow-right\"]],\n    template: function TextConsoleActionComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵtemplate(2, TextConsoleActionComponent_span_2_Template, 1, 2, \"span\", 2);\n        i0.ɵɵelement(3, \"div\", 3, 4);\n        i0.ɵɵpipe(5, \"obfuscation\");\n        i0.ɵɵtemplate(6, TextConsoleActionComponent_span_6_Template, 1, 2, \"span\", 5);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵstyleProp(\"background-color\", ctx.primaryColor);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction2(14, _c1, !ctx.inverted, ctx.inverted));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.inverted);\n        i0.ɵɵadvance(1);\n        i0.ɵɵclassMapInterpolate1(\"text-message-\", ctx.indexAction, \"\");\n        i0.ɵɵstyleProp(\"color\", ctx.textColor);\n        i0.ɵɵproperty(\"innerHTML\", i0.ɵɵpipeBind2(5, 11, ctx.action.text, ctx.textColor), i0.ɵɵsanitizeHtml);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.inverted);\n      }\n    },\n    styles: [\"ul, ol {\\n  white-space: normal !important;\\n}\\n\\n.bubble-arrow, .bubble-arrow-right {\\n  position: absolute;\\n  bottom: 0px;\\n  border-width: 8px;\\n  border-bottom: 0;\\n  border-top: 8px solid transparent;\\n  top: calc(100% - 8px);\\n}\\n\\n.bubble-arrow {\\n  left: 0;\\n  border-left: 0;\\n  margin-left: -8px;\\n  border-right-style: solid;\\n}\\n\\n.bubble-arrow-right {\\n  right: 0;\\n  border-right: 0;\\n  margin-right: -8px;\\n  border-left-style: solid;\\n}\\n\\n.bubble {\\n  font: 14px/16px Heebo;\\n}\\n.bubble a {\\n  color: inherit;\\n}\\n\\n.console-text-type .bubble {\\n  position: relative;\\n  padding: 12px;\\n  border-radius: 12px;\\n  white-space: pre-wrap;\\n}\\n.console-text-type .bubble ul,\\n.console-text-type .bubble ol {\\n  white-space: normal;\\n}\\n.console-text-type .bubble.bot {\\n  margin: 16px 24px 0 8px;\\n  word-break: break-word;\\n  color: #ffffff;\\n  border-bottom-left-radius: 0;\\n  background: #30b286;\\n  float: left;\\n}\\n.console-text-type .bubble.user {\\n  margin: 16px 8px 0 24px;\\n  word-break: break-word;\\n  color: #2c3f59;\\n  border-bottom-right-radius: 0;\\n  background: #c5dbea;\\n  float: right;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3Byb2plY3RzL2NsdXN0YWFyLXdlYmNoYXQtY29tcG9uZW50cy9zcmMvbGliL3NoYXJlZC5zY3NzIiwid2VicGFjazovLy4vcHJvamVjdHMvY2x1c3RhYXItd2ViY2hhdC1jb21wb25lbnRzL3NyYy9saWIvdGV4dC90ZXh0LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSw4QkFBQTtBQ0NGOztBREVBO0VBQ0Usa0JBQUE7RUFDQSxXQUFBO0VBQ0EsaUJBQUE7RUFDQSxnQkFBQTtFQUNBLGlDQUFBO0VBQ0EscUJBQUE7QUNDRjs7QURFQTtFQUNFLE9BQUE7RUFDQSxjQUFBO0VBQ0EsaUJBQUE7RUFDQSx5QkFBQTtBQ0NGOztBREVBO0VBQ0UsUUFBQTtFQUNBLGVBQUE7RUFDQSxrQkFBQTtFQUNBLHdCQUFBO0FDQ0Y7O0FERUE7RUFDRSxxQkFBQTtBQ0NGO0FEQUU7RUFDRSxjQUFBO0FDRUo7O0FBN0JFO0VBQ0Usa0JBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxxQkFBQTtBQWdDSjtBQTlCSTs7RUFFRSxtQkFBQTtBQWdDTjtBQTdCSTtFQUNFLHVCQUFBO0VBQ0Esc0JBQUE7RUFDQSxjQUFBO0VBQ0EsNEJBQUE7RUFDQSxtQkFBQTtFQUNBLFdBQUE7QUErQk47QUE1Qkk7RUFDRSx1QkFBQTtFQUNBLHNCQUFBO0VBQ0EsY0FBQTtFQUNBLDZCQUFBO0VBQ0EsbUJBQUE7RUFDQSxZQUFBO0FBOEJOIiwic291cmNlc0NvbnRlbnQiOlsidWwsIG9sIHtcbiAgd2hpdGUtc3BhY2U6IG5vcm1hbCAhaW1wb3J0YW50O1xufVxuXG4uYnViYmxlLWFycm93LCAuYnViYmxlLWFycm93LXJpZ2h0IHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBib3R0b206IDBweDtcbiAgYm9yZGVyLXdpZHRoOiA4cHg7XG4gIGJvcmRlci1ib3R0b206IDA7XG4gIGJvcmRlci10b3A6IDhweCBzb2xpZCB0cmFuc3BhcmVudDtcbiAgdG9wOiBjYWxjKDEwMCUgLSA4cHgpO1xufVxuXG4uYnViYmxlLWFycm93IHtcbiAgbGVmdDogMDtcbiAgYm9yZGVyLWxlZnQ6IDA7XG4gIG1hcmdpbi1sZWZ0OiAtOHB4O1xuICBib3JkZXItcmlnaHQtc3R5bGU6IHNvbGlkO1xufVxuXG4uYnViYmxlLWFycm93LXJpZ2h0IHtcbiAgcmlnaHQ6IDA7XG4gIGJvcmRlci1yaWdodDogMDtcbiAgbWFyZ2luLXJpZ2h0OiAtOHB4O1xuICBib3JkZXItbGVmdC1zdHlsZTogc29saWQ7XG59XG5cbi5idWJibGUge1xuICBmb250OiAxNHB4LzE2cHggSGVlYm87XG4gIGEge1xuICAgIGNvbG9yOiBpbmhlcml0O1xuICB9XG59XG4iLCJAaW1wb3J0ICcuLi9zaGFyZWQnO1xuXG4uY29uc29sZS10ZXh0LXR5cGUge1xuICAuYnViYmxlIHtcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgcGFkZGluZzogMTJweDtcbiAgICBib3JkZXItcmFkaXVzOiAxMnB4O1xuICAgIHdoaXRlLXNwYWNlOiBwcmUtd3JhcDtcblxuICAgIHVsLFxuICAgIG9sIHtcbiAgICAgIHdoaXRlLXNwYWNlOiBub3JtYWw7XG4gICAgfVxuXG4gICAgJi5ib3Qge1xuICAgICAgbWFyZ2luOiAxNnB4IDI0cHggMCA4cHg7XG4gICAgICB3b3JkLWJyZWFrOiBicmVhay13b3JkO1xuICAgICAgY29sb3I6ICNmZmZmZmY7XG4gICAgICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAwO1xuICAgICAgYmFja2dyb3VuZDogIzMwYjI4NjtcbiAgICAgIGZsb2F0OiBsZWZ0O1xuICAgIH1cblxuICAgICYudXNlciB7XG4gICAgICBtYXJnaW46IDE2cHggOHB4IDAgMjRweDtcbiAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7XG4gICAgICBjb2xvcjogIzJjM2Y1OTtcbiAgICAgIGJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOiAwO1xuICAgICAgYmFja2dyb3VuZDogI2M1ZGJlYTtcbiAgICAgIGZsb2F0OiByaWdodDtcbiAgICB9XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */\"],\n    encapsulation: 2,\n    changeDetection: 0\n  });\n}","map":{"version":3,"names":["EventEmitter","i0","ɵɵelement","ɵɵstyleProp","ctx_r0","primaryColor","ctx_r2","TextConsoleActionComponent","constructor","cdr","inverted","textColor","autoScroll","onLoadNextAction","onLastActionRendered","onLinkClicked","ngOnInit","emit","setTimeout","element","document","getElementById","scrollTop","scrollHeight","clientHeight","markForCheck","ngAfterViewInit","textElement","nativeElement","onclick","event","target","href","nodeName","url","label","innerText","Array","from","querySelectorAll","indexAction","forEach","a","getAttribute","setAttribute","ɵɵdirectiveInject","ChangeDetectorRef","selectors","viewQuery","TextConsoleActionComponent_Query","rf","ctx","ɵɵelementStart","ɵɵtemplate","TextConsoleActionComponent_span_2_Template","TextConsoleActionComponent_span_6_Template","ɵɵelementEnd","ɵɵadvance","ɵɵproperty","ɵɵpureFunction2","_c1","ɵɵclassMapInterpolate1","ɵɵpipeBind2","action","text","ɵɵsanitizeHtml"],"sources":["/home/smez/apps/webchat-components/projects/clustaar-webchat-components/src/lib/text/text.ts","/home/smez/apps/webchat-components/projects/clustaar-webchat-components/src/lib/text/text.html"],"sourcesContent":["import {\n  AfterViewInit,\n  ChangeDetectionStrategy,\n  ChangeDetectorRef,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Input,\n  OnInit,\n  Output,\n  ViewChild,\n  ViewEncapsulation\n} from '@angular/core';\n\n@Component({\n  selector: 'text-console-action',\n  templateUrl: './text.html',\n  styleUrls: ['./text.scss'],\n  encapsulation: ViewEncapsulation.None,\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class TextConsoleActionComponent implements OnInit, AfterViewInit {\n  @Input() indexAction: number;\n  @Input() action: any;\n  @Input() inverted: boolean = false;\n  @Input() primaryColor: string = '#30B286';\n  @Input() textColor: string = '#FFFFFF';\n  @Input() autoScroll? = true;\n  @Output() onLoadNextAction = new EventEmitter<boolean>();\n  @Output() onLastActionRendered = new EventEmitter<boolean>();\n  @Output() onLinkClicked = new EventEmitter<{ url: string; label: string }>();\n\n  @ViewChild('textElement') textElement: ElementRef;\n\n  constructor(private cdr: ChangeDetectorRef) {}\n\n  ngOnInit() {\n    this.onLoadNextAction.emit(true);\n\n    if (this.autoScroll) {\n      setTimeout(() => {\n        let element = document.getElementById('chat-console-messages');\n        if (element != null) {\n          element.scrollTop = element.scrollHeight - element.clientHeight;\n          this.cdr.markForCheck();\n        }\n      }, 500);\n    }\n    this.cdr.markForCheck();\n  }\n\n  ngAfterViewInit() {\n    this.textElement.nativeElement.onclick = (event) => {\n      if (event.target.href && event.target.nodeName === 'A') {\n        this.onLinkClicked.emit({\n          url: event.target.href,\n          label: event.target.innerText\n        });\n      }\n    };\n\n    Array.from(\n      document.querySelectorAll('.text-message-' + this.indexAction + ' a')\n    ).forEach(function (a) {\n      if (a.getAttribute('target') == null) {\n        a.setAttribute('target', '_blank');\n      }\n    });\n    this.cdr.markForCheck();\n\n    setTimeout(() => {\n      this.onLastActionRendered.emit(true);\n      this.cdr.markForCheck();\n    }, 0);\n  }\n}\n","<div class=\"console-text-type\">\n  <div class=\"bubble\" [ngClass]=\"{'bot' : ! inverted, 'user': inverted}\" [style.background-color]=\"primaryColor\">\n    <span *ngIf=\"!inverted\" [style.border-right-color]=\"primaryColor\" class=\"bubble-arrow\"></span>\n    <div #textElement [style.color]=\"textColor\" class=\"text-message-{{indexAction}}\" [innerHTML]=\"action.text | obfuscation: textColor\"></div>\n    <span *ngIf=\"inverted\" [style.border-left-color]=\"primaryColor\" class=\"bubble-arrow-right\"></span>\n  </div>\n</div>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}